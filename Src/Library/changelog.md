---

## ‚ú® Looking For Sponsors ‚ú®

FastEndpoints needs sponsorship to [sustain the project](https://github.com/FastEndpoints/FastEndpoints/issues/449). Please help out if you can.

---

[//]: # (<details><summary>title text</summary></details>)

## New üéâ

<details><summary>Check if app is being run in Swagger Json export mode and/or Api Client Generation mode</summary>

You can now use the following new extension methods for conditionally configuring your middleware pipeline depending on the mode the app is running in:

#### WebApplicationBuilder Extensions

```csharp
bld.IsNotGenerationMode(); //returns true if running normally
bld.IsApiClientGenerationMode(); //returns true if running in client gen mode
bld.IsSwaggerJsonExportMode(); //returns true if running in swagger export mode
```

#### WebApplication Extensions

```csharp
app.IsNotGenerationMode(); //returns true if running normally
app.IsApiClientGenerationMode(); //returns true if running in client gen mode
app.IsSwaggerJsonExportMode(); //returns true if running in swagger export mode
```

</details>

## Improvements üöÄ

<details><summary>Change default redirection behavior of cookie authentication middleware</summary>

The default behavior of the ASP.NET cookie auth middleware is to automatically return a redirect response when current user is either not authenticated or unauthorized. This default behavior is not appropriate for REST APIs because there's typically no login UI page as part of the backend server to redirect to, which results in a `404 - Not Found` error which confuses people that's not familiar with the cookie auth middleware. The default behavior has now been overridden to correctly return a `401 - Unauthorized` & `403 - Forbidden` as necessary without any effort from the developer.

</details>

<details><summary>Change 'RoleClaimType' of cookie auth to non-soap value</summary>

Until now, the `CookieAuth.SignInAsync()` method was using the long soap version of 'Role Claim Type' value `http://schemas.microsoft.com/ws/2008/06/identity/claims/role` which is not in line with what FE uses for JWT tokens. Now both JWT & Cookie auth uses the same value from the global config which is set like below or it's default value `role`:

```csharp
app.UseFastEndpoints(c=>c.Security.RoleClaimType = "role");
```

</details>

<details><summary>Workaround for CookieAuth middleware 'IsPersistent' misbehavior</summary>

By default, in ASP.NET Cookie middleware, if you specify an `Expiry` or `Max-Age` at the global/middleware level, setting `IsPersitent = false` will have no effect when signing in the user, as the middleware sets `Expiry/Max-Age` on the generated cookie anyway, making it a persistent cookie. A workaround has been implemented to fix this behavior.

</details>

## Fixes ü™≤

<details><summary>[HideFromDocs] attribute missing issue with the source generator</summary>

If the consuming project didn't have a `global using FastEndpoints;` statement, the generated classes would complain about not being able to located the said attribute, which has now been rectified.

</details>

<details><summary>Service registration source generator issue with third party source generators</summary>

The service registration source generator was encountering a compatibility issue with partial classes generated by other source generators such as Mapster, which has no been fixed.

</details>

## Minor Breaking Changes ‚ö†Ô∏è