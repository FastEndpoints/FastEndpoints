---

## ‚ùáÔ∏è Help Keep FastEndpoints Free & Open-Source ‚ùáÔ∏è

Due to the current [unfortunate state of FOSS](https://www.youtube.com/watch?v=H96Va36xbvo), please consider [becoming a sponsor](https://opencollective.com/fast-endpoints) and help us beat the odds to keep the project alive and free for everyone.

---

<!-- <details><summary>title text</summary></details> -->

## New üéâ

<details><summary>.NET 9.0 Support</summary>

Migration to .NET 9.0 SDK is now complete. You can now target `net9.0` sdk without any issues.

</details>

<details><summary>Support for enforcing antiforgery token checks for non-form requests</summary>

The antiforgery middleware can now be configured to check antiforgery tokens for any content-type by configuring it like so:

```csharp
app.UseAntiforgeryFE(additionalContentTypes: ["application/json"])
```

</details>

<details><summary>User configurable Endpoint Name (Operation Id) generation</summary>

The endpoint name generation logic can now be overriden at a global level like so:

```csharp
app.UseFastEndpoints(
       c => c.Endpoints.NameGenerator =
                ctx =>
                {
                    return ctx.EndpointType.Name.TrimEnd("Endpoint");
                })
```

</details>

<details><summary>Global configuration of 'JwtCreationOptions'</summary>

You can now configure `JwtCreationOptions` once globally like so:

```csharp
bld.Services.Configure<JwtCreationOptions>(
       o =>
       {
           o.SigningKey = "...";
           o.Audience = "...";
           o.Issuer = "...";
       })
```

and only specify just the relevant settings that are needed to be set during token creation like so.

```csharp
var token = JwtBearer.CreateToken(
    o =>
    {
        o.ExpireAt = DateTime.UtcNow.AddHours(1);
        o.User.Claims.Add(("UserId", "001"));
    });
```

If you need to override any of the globally specified settings, that can be done during token creation as well as what's supplied to the `CreateToken(o=> ...)` method is a deeply cloned instance independant of the global instance.

</details>

<details><summary>New endpoint versioning strategy based on 'Release Versions'</summary>

todo: write docs + write brief explanation here or link to docs

</details>

## Improvements üöÄ

<details><summary>Swagger OneOf support for polymorphic responses</summary>

When enabling `OneOf` for polymorphism like the following:

```csharp
.SwaggerDocument(c => c.UseOneOfForPolymorphism = true)
```

The correct response swagger spec is not generated by NSwag by default. As requested by #807, the correct spec will now be generated.

</details>

<details><summary>Default response metadata for endpoints without a response type</summary>

Previously, if the endpoint doesn't define a particular response DTO type, a default produces 200 response metadata was being added which resulted in swagger spec like the following:

```json
"responses": { 
  "200": { 
    "description": "Success", 
    "content": { 
      "text/plain": { 
        "schema": {} 
      }, 
      "application/json": { 
        "schema": {} 
      } 
    } 
  }
```

Even though it's not incorrect, it can cause issues in some cases such as for TS client generation. From now on if the endpoint doesn't specify a response DTO type, a 204 - No Content produces metadata would be added by default which results in more correct swagger spec such as the following:

```json
"responses": { 
  "204": { 
    "description": "No Content" 
  }
}
```

</details>

<details><summary>Detection of mapper type in unit tests</summary>

The logic for automatically detecting the endpoint mapper type during unit tests has been improved to prevent any "Endpoint mapper not set!" exceptions in some cases.

</details>

## Fixes ü™≤

<details><summary>Struct support for request DTOs</summary>

Adding the new reflection source generator broke support for struct types to be used for request DTOs, which has been corrected in this release.

</details>

<details><summary>Struct support for Reflection Source Generator</summary>

The reflection generator was not generating the correct source for unboxing value types.

</details>

<details><summary>Reflection generation for abstract types</summary>

The reflection generator was trying to generate code for deeply nested abstract types, which has now been fixed.

</details>

<details><summary>Incorrect constructor detection in Reflection Generator</summary>

The reflection generator was wrongly detecting constructors from base types instead of just stopping at the top most level.

</details>

<details><summary>Included validators causing an exception</summary>

There was a regression in the validation schema processor which resulted in included fluent validators causing an exception at the time of generating the swagger spec.

</details>

<details><summary>Unescaped back slashes breaking model binding</summary>

Incorrectly unescaped parameter values from the client was causing model binding failures which has been now corrected. 

</details>

<details><summary>Rogue 200 response in Swagger spec</summary>

Due to a known bug in the .NET 9.0 SDK, a rogue 200 response metadata was being added to endpoints if the endpoints response DTO type is an `IResult` type and it's not s 200 status code. A workaround has been put in place to prevent that from happening.

</details>

<!-- ## Minor Breaking Changes ‚ö†Ô∏è -->